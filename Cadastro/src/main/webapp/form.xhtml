<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <title>Cadastro de Pessoa</title>
</h:head>
<h:body>
    <b:container class="mt-4">
        <b:messages id="msgs" showDetail="true" autoUpdate="true" closable="true" />

        <h:form id="formPessoa">
            <!-- DADOS PESSOAIS -->
            <b:panel title="#{pessoaBean.pessoa.id == null ? 'Nova Pessoa' : 'Editar Pessoa'}"
                     look="primary"
                     iconAwesome="user"
                     class="mb-4 shadow-sm">
                <b:row>
                    <b:column col-md="6" col-sm="12" class="mb-2">
                        <p:inputText id="nome"
                                     value="#{pessoaBean.pessoa.nome}"
                                     required="true"
                                     requiredMessage="O campo Nome é obrigatório"
                                     placeholder="Digite o nome completo" />
                        <b:message for="nome"/>
                    </b:column>

                    <b:column col-md="3" col-sm="6" class="mb-2">
                        <p:inputNumber id="idade"
                                       value="#{pessoaBean.pessoa.idade}"
                                       required="true"
                                       requiredMessage="Informe a idade"
                                       placeholder="Idade" />
                        <b:message for="idade"/>
                    </b:column>

                    <b:column col-md="3" col-sm="6" class="mb-2">
                        <p:selectOneMenu id="sexo"
                                         value="#{pessoaBean.pessoa.sexo}"
                                         required="true"
                                         requiredMessage="Selecione o sexo">
                            <f:selectItem itemLabel="Selecione" itemValue="" />
                            <f:selectItem itemLabel="Masculino" itemValue="M" />
                            <f:selectItem itemLabel="Feminino" itemValue="F" />
                        </p:selectOneMenu>
                        <b:message for="sexo"/>
                    </b:column>
                </b:row>
            </b:panel>

            <!-- ENDEREÇOS -->
            <b:panel title="Endereços" look="success" iconAwesome="map-marker" class="mb-4 shadow-sm">
                <p:dataTable id="tabelaEnderecos"
                             value="#{pessoaBean.pessoa.enderecos}"
                             var="endereco"
                             styleClass="table table-sm">
                    <p:column headerText="CEP">
                        <p:inputMask value="#{endereco.cep}" mask="99999-999" placeholder="00000-000"/>
                    </p:column>

                    <p:column headerText="Cidade">
                        <p:inputText value="#{endereco.cidade}" placeholder="Ex: São Paulo"/>
                    </p:column>

                    <p:column headerText="Estado">
                        <p:selectOneMenu value="#{endereco.estado}">
                            <f:selectItem itemLabel="Selecione" itemValue="" />
                            <f:selectItems value="#{pessoaBean.estadosBrasil}"
                                           var="estado"
                                           itemLabel="#{estado.nome}"
                                           itemValue="#{estado.sigla}" />
                        </p:selectOneMenu>
                    </p:column>

                    <p:column headerText="Número">
                        <p:inputText value="#{endereco.numero}" placeholder="Nº"/>
                    </p:column>

                    <p:column headerText="Ações">
                        <b:commandButton value="Remover"
                                         look="danger"
                                         icon="trash"
                                         action="#{pessoaBean.removerEndereco(endereco)}"
                                         ajax="true"
                                         update="formPessoa:tabelaEnderecos formPessoa:msgs" />
                    </p:column>
                </p:dataTable>

                <b:commandButton value="Adicionar Endereço"
                                 look="info"
                                 icon="plus"
                                 action="#{pessoaBean.adicionarEndereco}"
                                 ajax="true"
                                 update="formPessoa:tabelaEnderecos formPessoa:msgs"
                                 styleClass="mt-3 mb-2"/>
            </b:panel>

            <!-- BOTÕES FINAIS -->
            <b:row>
                <b:column col-md="3" col-sm="6" class="mb-2">
                    <b:commandButton value="Salvar" look="success" icon="save"
                                     action="#{pessoaBean.salvar}" ajax="false" block="true"/>
                </b:column>
                <b:column col-md="3" col-sm="6" class="mb-2">
                    <b:button value="Voltar" look="secondary" icon="arrow-left"
                              outcome="index" block="true"/>
                </b:column>
            </b:row>
        </h:form>
    </b:container>
</h:body>
</html>